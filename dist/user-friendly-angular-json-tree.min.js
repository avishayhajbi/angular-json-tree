/*global angular */
!function(){"use strict";var e={},n={is:function(e,n){return Object.prototype.toString.call(e).slice(8,-1)===n},whatClass:function(e){return Object.prototype.toString.call(e).slice(8,-1)},forKeys:function(e,n){for(var a in e)if(e.hasOwnProperty(a)&&"function"!=typeof e[a]&&n(a,e[a]))break},unCamelCase:function(e){return"string"==typeof e?e.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/\b([A-Z]+)([A-Z])([a-z])/,"$1 $2$3").replace(/^./,function(e){return e.toUpperCase()}):e},isEmpty:function(e){if(null==e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;if("object"!=typeof e)return!0;for(var n in e)if(hasOwnProperty.call(e,n))return!1;return!0},includes:function(e,n){return e&&"string"==typeof e&&e.indexOf(n)>=0}};angular.module("user-friendly-angular-json-tree",["ajs.RecursiveDirectiveHelper"]).directive("userFriendlyJsonTree",[function(){return{restrict:"E",scope:{object:"=",startExpanded:"&?",rootName:"&?",options:"="},template:'<user-friendly-json-node key="rootName() || \'Object\'" value="object" start-expanded="startExpanded()"></user-friendly-json-node>',link:function(n,a,t){e={toggleBranchText:n.options.toggleBranchText||"click to expand",emptyValueText:n.options.emptyValueText||"none",dateFormat:n.options.dateFormat||"yyyy-MM-dd HH:mm:ss"}}}}]).directive("userFriendlyJsonNode",["ajsRecursiveDirectiveHelper","$filter",function(a,t){return{restrict:"E",scope:{key:"=",value:"=",startExpanded:"&?"},compile:function(e){return a.compile(e,this)},template:' <span class="key" ng-click="toggleExpanded()">{{formatedKey}}</span>       <span class="leaf-value" ng-if="!isExpandable">{{value ? value : options.emptyValueText}}</span>       <span class="branch-preview" ng-if="isExpandable" ng-show="!isExpanded" ng-click="toggleExpanded()">{{options.toggleBranchText}}</span>       <ul class="branch-value" ng-if="isExpandable && shouldRender" ng-show="isExpanded">           <li ng-repeat="(subkey,subval) in value">               <user-friendly-json-node key="subkey" value="subval"></user-friendly-json-node>           </li>       </ul>',pre:function(a,r,s){a.options=e,a.formatedKey=n.unCamelCase(a.key),r.addClass(n.whatClass(a.value).toLowerCase()),n.is(a.value,"Object")||n.is(a.value,"Array")?n.isEmpty(a.value)?(a.isExpandable=!1,a.value=a.options.emptyValueText):(a.isExpandable=!0,r.addClass("expandable"),a.startExpanded&&a.startExpanded()&&(a.shouldRender=!0,r.addClass("expanded")),a.isExpanded=!!a.startExpanded&&a.startExpanded(),a.toggleExpanded=function(){a.isExpanded=!a.isExpanded,a.isExpanded?r.addClass("expanded"):r.removeClass("expanded"),a.shouldRender=!0}):(a.isExpandable=!1,r.addClass("not-expandable"),n.includes(a.formatedKey,"Date")&&!isNaN(a.value)&&(a.value=t("date")(a.value,a.options.dateFormat)))}}}]),angular.module("ajs.RecursiveDirectiveHelper",[]).factory("ajsRecursiveDirectiveHelper",["$compile",function(e){return{compile:function(n,a){angular.isFunction(a)&&(a={post:a});var t,r=n.contents().remove();return{pre:a&&a.pre?a.pre:null,post:function(n,s){t||(t=e(r)),t(n,function(e){s.append(e)}),a&&a.post&&a.post.apply(null,arguments)}}}}}])}();